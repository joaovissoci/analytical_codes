---
title: "SAP Report - Faculty"
output: 
  flexdashboard::flex_dashboard:
  orientation: rows
  theme: journal
  social: menu
  source_code: https://git.io/vaZdx
  runtime: shiny
---
    
```{r setup, include=FALSE}
library(flexdashboard)
library(dplyr)
library(lubridate)
library(dygraphs)
library(xts)
library(tidyverse)
library(plotly)

#to run and generate the dashboard
#rmarkdown::run("/Users/Joao/Desktop/deleteme.Rmd")

# Access to CRAN packages data stream
# source("/Users/Joao/Desktop/package_stream.R")

#original data
# data_01<-read.csv("/Users/joaovissoci/Box Sync/Home Folder jnv4/Data/DGNN/sap_neuro/US_sap_data.csv",sep=",")

data_01<-structure(list(X...recoder_date = structure(c(80L, 102L, 37L, 
10L, 104L, 107L, 33L, 105L, 69L, 78L, 89L, 84L, 86L, 67L, 34L, 
34L, 35L, 36L, 39L, 40L, 38L, 38L, 43L, 28L, 30L, 2L, 9L, 11L, 
14L, 18L, 20L, 21L, 24L, 25L, 26L, 50L, 51L, 59L, 58L, 60L, 61L, 
61L, 62L, 63L, 64L, 65L, 66L, 68L, 82L, 82L, 70L, 70L, 71L, 75L, 
76L, 77L, 85L, 91L, 94L, 110L, 97L, 98L, 101L, 106L, 111L, 31L, 
32L, 22L, 52L, 53L, 33L, 33L, 92L, 84L, 100L, 5L, 6L, 88L, 81L, 
79L, 96L, 103L, 87L, 4L, 27L, 3L, 42L, 46L, 47L, 48L, 79L, 112L, 
99L, 108L, 29L, 41L, 17L, 19L, 56L, 72L, 15L, 22L, 90L, 73L, 
33L, 109L, 23L, 74L, 57L, 7L, 8L, 44L, 45L, 16L, 93L, 83L, 49L, 
13L, 95L, 54L, 55L, 95L, 12L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L), .Label = c("", "1/10/17 14:31", "1/11/17 15:59", 
"1/11/17 18:06", "1/12/17 06:41", "1/12/17 06:43", "1/12/17 06:44", 
"1/12/17 06:45", "1/12/17 13:43", "1/12/17 16:08", "1/13/17 02:10", 
"1/13/17 06:47", "1/13/17 08:23", "1/13/17 09:22", "1/18/17 03:58", 
"1/18/17 04:01", "1/18/17 11:27", "1/18/17 17:03", "1/19/17 05:41", 
"1/19/17 19:01", "1/22/17 12:17", "1/24/17 19:42", "1/25/17 20:14", 
"1/26/17 03:06", "1/26/17 04:50", "1/26/17 08:36", "1/4/17 07:22", 
"1/4/17 19:26", "1/8/17 09:49", "1/8/17 19:50", "1/9/17 19:42", 
"1/9/17 19:43", "11/20/16", "11/23/16", "12/1/16 19:52", "12/1/16 19:53", 
"12/14/16 06:20", "12/15/16", "12/15/16 05:09", "12/15/16 05:11", 
"12/22/16 03:06", "12/22/16 09:46", "12/22/16 09:58", "12/29/16 09:17", 
"12/29/16 09:20", "12/29/16 09:45", "12/29/16 09:46", "12/29/16 09:47", 
"2/15/17 18:03", "2/16/17 20:34", "2/16/17 20:37", "2/2/17 10:50", 
"2/2/17 10:51", "2/7/17 18:19", "2/7/17 18:21", "3/1/17 10:09", 
"3/1/17 18:13", "3/11/17 10:54", "3/9/17 05:17", "4/20/17 08:04", 
"4/20/17 08:05", "4/24/17 19:25", "4/24/17 19:26", "4/26/17 15:05", 
"4/26/17 15:06", "4/26/17 17:00", "4/28/17 20:50", "4/29/17 13:47", 
"4/7/17 12:35", "5/15/17 04:28", "5/18/17 08:24", "5/18/17 08:26", 
"5/20/17 09:36", "5/20/17 14:39", "5/20/17 14:40", "5/21/17 08:39", 
"5/21/17 08:40", "5/26/17 16:14", "5/27/17 08:37", "5/8/17 12:24", 
"5/8/17 12:25", "5/8/17 20:34", "5/9/17 08:22", "6/13/17 18:14", 
"6/2/17 08:22", "6/21/17 05:11", "6/25/17 04:53", "6/30/17 10:47", 
"6/6/17 07:47", "6/7/17 10:14", "6/7/17 10:35", "6/7/17 11:39", 
"6/7/17 14:13", "6/7/17 15:10", "7/11/17 15:22", "7/11/17 17:55", 
"7/13/17 12:06", "7/13/17 12:07", "7/14/17 04:07", "7/14/17 06:27", 
"7/14/17 06:28", "7/16/17 20:56", "7/17/17 20:55", "7/20/17 21:07", 
"7/23/17 15:59", "7/30/17 14:39", "7/31/17 21:39", "7/31/17 21:40", 
"7/31/17 21:43", "7/5/17 18:25", "7/6/17 09:31", "9/18/17 06:15"
), class = "factor"), record_duration = c(48L, 19L, 52L, 31L, 
21L, 20L, 39L, 19L, 173L, 32L, 82L, 21L, 18L, 38L, 172L, 34L, 
52L, 23L, 180L, 185L, 37L, 27L, 97L, 115L, 34L, 167L, 36L, 38L, 
107L, 26L, 18L, 46L, 72L, 52L, 121L, 65L, 161L, 94L, 73L, 28L, 
16L, 14L, 43L, 84L, 52L, 23L, 54L, 65L, 57L, 12L, 29L, 27L, 129L, 
19L, 18L, 33L, 33L, 76L, 44L, 57L, 42L, 16L, 30L, 13L, 51L, 47L, 
28L, 20L, 28L, 19L, 24L, 35L, 56L, 19L, 29L, 44L, 66L, 14L, 20L, 
26L, 46L, 16L, 74L, 101L, 115L, 180L, 78L, 31L, 35L, 29L, 18L, 
19L, 48L, 17L, 88L, 148L, 31L, 24L, 128L, 100L, 40L, 26L, 44L, 
30L, 52L, 13L, 55L, 31L, 130L, 22L, 21L, 39L, 35L, 31L, 41L, 
177L, 35L, 63L, 28L, 49L, 80L, 20L, 199L, NA, NA, NA, NA, NA, 
NA, NA, NA, NA, NA, NA, NA), q2_feedback_during_operation = structure(c(3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 5L, 5L, 5L, 
5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 
5L, 5L, 2L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "No significant feedback.", 
"Significant feedback: both stretching and affirming.", "Some feedback, but limited.", 
"Some feedback, but valuable."), class = "factor"), q3_feedback_evaluation_form = structure(c(3L, 
3L, 3L, 3L, 4L, 4L, 3L, 5L, 3L, 3L, 3L, 3L, 3L, 5L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 5L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 5L, 3L, 3L, 3L, 3L, 5L, 4L, 
5L, 2L, 3L, 5L, 3L, 5L, 5L, 5L, 5L, 5L, 3L, 5L, 5L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 4L, 5L, 5L, 3L, 3L, 5L, 3L, 3L, 5L, 5L, 
5L, 5L, 4L, 3L, 2L, 4L, 5L, 5L, 5L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "No significant feedback.", 
"Significant feedback: both stretching and affirming.", "Some feedback, but limited.", 
"Some feedback, but valuable."), class = "factor"), Q4_feedback_lead_to = structure(c(2L, 
15L, 22L, 22L, 2L, 8L, 5L, 8L, 10L, 8L, 2L, 14L, 4L, 22L, 4L, 
12L, 5L, 5L, 13L, 12L, 5L, 11L, 11L, 21L, 21L, 14L, 14L, 21L, 
21L, 5L, 5L, 5L, 10L, 10L, 16L, 7L, 7L, 21L, 9L, 16L, 9L, 9L, 
14L, 17L, 4L, 21L, 21L, 16L, 24L, 8L, 16L, 9L, 19L, 12L, 14L, 
4L, 4L, 14L, 14L, 10L, 8L, 16L, 14L, 16L, 10L, 11L, 16L, 10L, 
10L, 10L, 4L, 12L, 14L, 8L, 3L, 10L, 10L, 9L, 2L, 2L, 14L, 8L, 
4L, 9L, 21L, 17L, 12L, 12L, 12L, 12L, 14L, 2L, 2L, 6L, 9L, 5L, 
5L, 14L, 23L, 14L, 21L, 10L, 16L, 9L, 12L, 6L, 21L, 21L, 18L, 
10L, 10L, 11L, 12L, 15L, 21L, 4L, 10L, 20L, 22L, 2L, 2L, 5L, 
5L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", 
"Ask more questions next time.", "Ask more questions next time.,Other (please enter text below):", 
"Other (please enter text below):", "Review anatomy.", "Review anatomy.,Ask more questions next time.", 
"Review anatomy.,Other (please enter text below):", "Review anatomy.,Review surgical approach.", 
"Review anatomy.,Review surgical approach.,Spend time studying complication avoidance.", 
"Review anatomy.,Review surgical approach.,Spend time studying complication avoidance.,Ask more questions next time.", 
"Review anatomy.,Spend time studying complication avoidance.", 
"Review anatomy.,Spend time studying complication avoidance.,Ask more questions next time.", 
"Review anatomy.,Spend time studying complication avoidance.,Ask more questions next time.,Other (please enter text below):", 
"Review surgical approach.", "Review surgical approach.,Ask more questions next time.", 
"Review surgical approach.,Spend time studying complication avoidance.", 
"Review surgical approach.,Spend time studying complication avoidance.,Ask more questions next time.", 
"Review surgical approach.,Spend time studying complication avoidance.,Ask more questions next time.,Other (please enter text below):", 
"Review surgical approach.,Spend time studying complication avoidance.,Other (please enter text below):", 
"Since not helpful, nothing to change.", "Spend time studying complication avoidance.", 
"Spend time studying complication avoidance.,Ask more questions next time.", 
"Spend time studying complication avoidance.,Ask more questions next time.,Other (please enter text below):", 
"Spend time studying complication avoidance.,Other (please enter text below):"
), class = "factor"), q4_text = structure(c(1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 7L, 1L, 5L, 1L, 1L, 1L, 15L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 11L, 
10L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 10L, 1L, 1L, 1L, 14L, 1L, 1L, 
1L, 12L, 1L, 1L, 4L, 13L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 5L, 1L, 1L, 1L, 6L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
8L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 9L, 1L, 1L, 1L, 1L, 1L, 
1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L), .Label = c("", "Ask to do case without fellow so I can have chance to demonstrate understanding of the case", 
"Be more aggressive ", "Change practice in OR", "Concentrate more on various techniques like drilling", 
"Fecci always great to operate with", "Further study of complex spine case", 
"I will try to recall the specific efficiency techniques next case to move through the case both safely and efficiently. ", 
"Nice case. The rosa cases obviously aren't technically challenging, but knowing the anatomy and planning aspects certainly can be. ", 
"Practice", "Practice techniques ", "Yeah, I agree, really tough case. Probably one of the more difficult interiors by infusions that I have done. Appreciate you taking me through in a way that we were able to avoid complications.", 
"continue to practice technical tips and methods in OR", "continue working on technique", 
"thank you for the feedback. Great learning yesterday"), class = "factor"), 
    q6_zones_use = structure(c(4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
    3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
    3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "No", "Partially", 
    "Yes"), class = "factor"), q7_suggestion_for_improvement = structure(c(11L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 28L, 1L, 1L, 1L, 10L, 1L, 1L, 
    1L, 1L, 1L, 1L, 29L, 1L, 1L, 17L, 26L, 1L, 1L, 1L, 20L, 8L, 
    1L, 1L, 1L, 1L, 24L, 2L, 13L, 12L, 16L, 23L, 1L, 1L, 1L, 
    1L, 22L, 1L, 1L, 1L, 25L, 1L, 1L, 1L, 1L, 21L, 1L, 1L, 1L, 
    1L, 5L, 1L, 1L, 14L, 1L, 27L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 30L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 15L, 
    1L, 6L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 18L, 1L, 1L, 1L, 
    9L, 4L, 1L, 1L, 7L, 1L, 1L, 1L, 1L, 1L, 19L, 1L, 1L, 1L, 
    1L, 1L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", " Ashley, I thought it was spot on feedback both intraoperatively and afterwards. ", 
    " Continue to make good suggestions throughout surgery, discuss prior experience and avoidance of complications. ", 
    " I don't really think the zones of proximal development have been established for this kind of a case, but certainly set up seems to be very important. The case itself is not very difficult once imaging has been properly set up. Agree, Consistently checking AP and lateral x-rays is very helpful to ensure avoidance of complications and proper graft placement", 
    "Always consistently provides helpful feedback.", "Appreciate intraopertive feedback as it helps me learn in a more immediate way and as a result more likely to not forget ", 
    "Awesome case!", "Be more guiding at times with intraoperative questions, at times feels that blame is being placed when questions asked to residents", 
    "Cannot identify much room for improvement. Feedback was very helpful. ", 
    "Continue Excellent teaching and preplanning reviews ", "Continue talking out loud what she is thinking throughout the procedure", 
    "Dr. Haglund is the master at ACDFs. He has so many helpful technical and anatomical nuances to this procedure. It has been a pleasure learning from him, and seeing how he has evolved at trying to get all the residents proficient at this. Awesome. A completely different experience than the past has been in the OR with him. Awesome. ", 
    "Excellent!", "Great how its obvious how he is thinking about how to get us through the difficult spots in the surgery when he is doing his own surgeries", 
    "I found the patients in your feedback helpful even though I repeatedly made the incorrect move", 
    "I would like for attending to talk me through things while I operate as opposed to showing me how to do things. At this point in training I find actually performing the movements to be very valuable. ", 
    "If the attending has a less operatively heavy caseload that day the resident can get more time operating and learning from their errors.", 
    "More focus in description of planned surgical approach, guidance when needed during difficult parts of tumor resection", 
    "Nice case. The rosa cases obviously aren't technically challenging, but knowing the anatomy and planning aspects certainly can be. I look forward to working with Dr. Haglund and the epileptologists next year in the more challenging parts of these cases, including workup and planning phases. ", 
    "None. Good ", "Not much to improve on here. Talked through the difficult parts of the case really well. ", 
    "Overall very effective feedback and appreciate your patience even though clearly I am struggling and delaying things", 
    "Really no tips for improvement on this one. Dr Haglund did a really good job teaching. ", 
    "Thank you got the feedback. Very helpful and encouraging. ", 
    "Very helpful feedback in regards to making my technique more efficient.", 
    "Was very patient with teaching, would encourage stopping to demonstrate or point out technique outside of operative field prior to actually performing it for the resident", 
    "Would be happy to operate with Dr Haglund everyday", "frequently points out important parts of the procedure and explains anatomy and approaches. Very good teacher ", 
    "great feedback. Perhaps asking more questions of the resident as working through the steps", 
    "reliable and valuable feedback. Will continue to work on merging teaching and learning styles "
    ), class = "factor"), case_date = structure(c(29L, 47L, 59L, 
    8L, 50L, 55L, 56L, 52L, 22L, 34L, 37L, 39L, 40L, 27L, 57L, 
    57L, 58L, 58L, 59L, 59L, 60L, 60L, 62L, 3L, 65L, 3L, 8L, 
    8L, 8L, 10L, 10L, 8L, 12L, 12L, 13L, 18L, 18L, 20L, 21L, 
    23L, 24L, 24L, 24L, 24L, 25L, 25L, 25L, 26L, 28L, 28L, 31L, 
    31L, 32L, 32L, 31L, 32L, 36L, 39L, 39L, 15L, 47L, 47L, 43L, 
    51L, 44L, 5L, 5L, 11L, 14L, 14L, 56L, 56L, 38L, 38L, 45L, 
    5L, 5L, 41L, 29L, 35L, 46L, 49L, 42L, 7L, 3L, 2L, 61L, 64L, 
    64L, 64L, 35L, 53L, 48L, 55L, 4L, 62L, 10L, 10L, 19L, 32L, 
    9L, 11L, 39L, 33L, 56L, 54L, 12L, 32L, 19L, 6L, 6L, 63L, 
    63L, 9L, 39L, 30L, 17L, 7L, 46L, 16L, 16L, 46L, 8L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "01/01/17", 
    "01/04/17", "01/05/17", "01/09/17", "01/10/17", "01/11/17", 
    "01/12/17", "01/17/17", "01/18/17", "01/24/17", "01/25/17", 
    "01/26/17", "01/31/17", "02/01/17", "02/07/17", "02/13/17", 
    "02/15/17", "03/01/17", "03/08/17", "03/09/17", "04/05/17", 
    "04/12/17", "04/19/17", "04/26/17", "04/27/17", "04/28/17", 
    "05/03/17", "05/08/17", "05/09/17", "05/11/17", "05/17/17", 
    "05/18/17", "05/24/17", "05/25/17", "05/31/17", "06/03/17", 
    "06/05/17", "06/07/17", "06/20/17", "06/22/17", "06/23/17", 
    "07/05/17", "07/06/17", "07/07/17", "07/11/17", "07/12/17", 
    "07/13/17", "07/17/17", "07/18/17", "07/19/17", "07/21/17", 
    "07/25/17", "07/27/17", "07/28/17", "11/20/16", "11/23/16", 
    "11/29/16", "12/14/16", "12/15/16", "12/20/16", "12/21/16", 
    "12/27/16", "12/28/16", "12/29/16"), class = "factor"), resident = structure(c(11L, 
    15L, 5L, 11L, 15L, 15L, 3L, 15L, 3L, 11L, 11L, 4L, 7L, 11L, 
    12L, 12L, 11L, 11L, 3L, 3L, 12L, 12L, 14L, 16L, 10L, 17L, 
    6L, 10L, 16L, 16L, 16L, 6L, 3L, 3L, 14L, 11L, 11L, 18L, 18L, 
    4L, 4L, 4L, 14L, 14L, 11L, 11L, 11L, 14L, 4L, 4L, 4L, 4L, 
    18L, 18L, 4L, 4L, 4L, 14L, 14L, 3L, 4L, 4L, 9L, 4L, 19L, 
    11L, 11L, 3L, 3L, 3L, 13L, 2L, 16L, 4L, 9L, 3L, 3L, 4L, 11L, 
    11L, 15L, 15L, 7L, 14L, 16L, 14L, 3L, 3L, 3L, 3L, 11L, 9L, 
    9L, 15L, 16L, 12L, 12L, 12L, 18L, 18L, 18L, 3L, 18L, 4L, 
    8L, 15L, 16L, 18L, 18L, 3L, 3L, 3L, 3L, 18L, 18L, 11L, 10L, 
    16L, 19L, 16L, 16L, 19L, 16L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L), .Label = c("", "Adam Back, M.D.", "Alexa Bramall, M.D.", 
    "Andrew Cutler, M.D.", "Avra S. Laarakker", "Jacquelyn Corley, M.D", 
    "John Berry-Candelario, M.D.", "John Berry-Canderlario, M.D.", 
    "Jordan Komisarow, M.D.", "Kimberly Hoang, M.D.", "Mary Cobb, M.D.", 
    "Ranjith Babu M.D.", "Ranjith Babu, M.D.", "Shervin Rahimpour, M.D.", 
    "Stephen Harward, M.D.", "Steven Cook, M.D.", "Theresa Williamson, M.D.", 
    "Timothy Miller, M.D.", "Vikram Mehta, M.D."), class = "factor"), 
    year = structure(c(7L, 3L, 2L, 7L, 3L, 3L, 5L, 3L, 3L, 7L, 
    7L, 3L, 8L, 7L, 4L, 4L, 1L, 1L, 3L, 3L, 4L, 4L, 4L, 7L, 6L, 
    4L, 3L, 6L, 7L, 7L, 7L, 3L, 1L, 3L, 4L, 7L, 7L, 6L, 6L, 3L, 
    3L, 3L, 4L, 4L, 7L, 7L, 7L, 4L, 3L, 3L, 3L, 3L, 6L, 6L, 3L, 
    3L, 3L, 4L, 4L, 3L, 4L, 4L, 6L, 1L, 3L, 7L, 7L, 3L, 3L, 3L, 
    2L, 3L, 7L, 3L, 6L, 3L, 3L, 3L, 7L, 7L, 3L, 3L, 8L, 4L, 7L, 
    4L, 3L, 3L, 3L, 3L, 7L, 6L, 6L, 3L, 7L, 4L, 4L, 4L, 6L, 6L, 
    6L, 3L, 6L, 3L, 4L, 3L, 7L, 6L, 6L, 3L, 3L, 3L, 3L, 6L, 6L, 
    7L, 6L, 7L, 3L, 7L, 7L, 3L, 7L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L), .Label = c("", "PGY1", "PGY2", "PGY3", 
    "PGY4", "PGY5", "PGY6", "PGY7"), class = "factor"), attending = structure(c(3L, 
    3L, 4L, 4L, 5L, 5L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 10L, 
    10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 
    10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 
    10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 
    10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 
    10L, 10L, 11L, 11L, 11L, 11L, 11L, 13L, 14L, 14L, 14L, 14L, 
    15L, 15L, 15L, 3L, 5L, 7L, 7L, 8L, 10L, 10L, 10L, 11L, 11L, 
    11L, 11L, 14L, 4L, 4L, 5L, 9L, 10L, 10L, 10L, 10L, 10L, 11L, 
    11L, 12L, 14L, 2L, 5L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 
    11L, 12L, 7L, 3L, 6L, 4L, 4L, 4L, 4L, 15L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "Allan Friedman, M.D.", 
    "Carrie Muh, M.D.", "Dennis Turner, M.D.", "Eric Thompson, M.D.", 
    "Erik Hauck, M.D.", "Herbert Fuchs, M.D., Ph.D.", "Isaac Karikari, M.D.", 
    "John Sampson, M.D., Ph.D.", "Michael Haglund, M.D., Ph.D.", 
    "Nandan Lad, M.D., Ph.D.", "Oren Gottfried, M.D.", "Patrick Codd, M.D.", 
    "Peter Fecci, M.D., Ph.D.", "Robert Isaacs, M.D."), class = "factor"), 
    subspecialty = structure(c(3L, 3L, 2L, 4L, 3L, 3L, 5L, 3L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 2L, 4L, 4L, 4L, 4L, 2L, 4L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 2L, 2L, 4L, 2L, 4L, 4L, 
    4L, 4L, 2L, 2L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 3L, 4L, 
    4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 2L, 
    2L, 2L, 2L, 3L, 5L, 5L, 5L, 4L, 4L, 4L, 2L, 3L, 3L, 3L, 4L, 
    4L, 2L, 4L, 2L, 2L, 2L, 2L, 5L, 2L, 4L, 3L, 5L, 2L, 2L, 2L, 
    4L, 4L, 2L, 2L, 4L, 5L, 4L, 3L, 2L, 4L, 2L, 2L, 2L, 2L, 2L, 
    2L, 4L, 3L, 2L, 4L, 2L, 2L, 2L, 2L, 4L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "Functional", 
    "Pediatrics", "Spine", "Tumor"), class = "factor"), case = structure(c(37L, 
    10L, 30L, 19L, 37L, 37L, 11L, 7L, 24L, 18L, 19L, 19L, 28L, 
    25L, 2L, 14L, 24L, 2L, 2L, 2L, 14L, 2L, 2L, 2L, 2L, 2L, 2L, 
    2L, 2L, 2L, 2L, 2L, 13L, 15L, 2L, 15L, 2L, 18L, 24L, 2L, 
    27L, 27L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 24L, 7L, 2L, 24L, 
    24L, 2L, 2L, 24L, 2L, 2L, 2L, 24L, 2L, 2L, 2L, 36L, 24L, 
    30L, 30L, 30L, 5L, 6L, 33L, 33L, 34L, 38L, 18L, 35L, 15L, 
    37L, 8L, 37L, 21L, 2L, 27L, 24L, 26L, 27L, 26L, 26L, 32L, 
    27L, 4L, 37L, 33L, 15L, 15L, 15L, 2L, 24L, 20L, 30L, 3L, 
    33L, 9L, 16L, 13L, 2L, 12L, 17L, 30L, 30L, 23L, 22L, 25L, 
    37L, 14L, 24L, 31L, 29L, 31L, 31L, 2L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "ACDF", "ALIF", 
    "Anterior cervical corpectomy", "Asleep CT-guided DBS", "Asleep MRI-guided DBS", 
    "Chiari Decompression", "Complex Tethered Cord/Spinal Dysraphism", 
    "Cordotomy", "Endoscopic CSF Diversion (ETV, cyst fenestration)", 
    "Epilepsy- Depth Electrodes", "Epilepsy-Depth Electrodes", 
    "Epilepsy-Grids/Strips", "Epilepsy-Temporal Lobectomy", "Epilepsy-VNS", 
    "Infratentorial (midline suboccipital, lateral) Craniotomy for Tumor", 
    "Intrathecal Pump", "Lumbar discectomy", "Lumbar laminectomy", 
    "Nucleus Caudalis DREZ (Atypical Facial Pain)", "Occipitocervical fusion", 
    "Percutaneous Epidural SCS Trial", "Permanent Paddle SCS Implant", 
    "Posterior cervical fusion", "Posterior lumbar Fusion (no interbody)", 
    "Revision/Removal SCS/Neurostimulator Implant", "Revision/Replacement of internal pulse generator", 
    "Scoliosis correction (kyphosis/scoliosis)", "Stage 1-Awake Frame-based DBS", 
    "Stage 1-Awake Frameless DBS", "Stage 2-DBS-implantation of internal pulse generator", 
    "Sub-occipital Decompression", "Supratentorial (convexity) Craniotomy for Tumor", 
    "Supratentorial (interhemispheric/bifrontal) Craniotomy for Tumor", 
    "TLIF (MIS)", "TLIF (open)", "VP Shunt", "XLIF (lumbar)"), class = "factor"), 
    zpd = structure(c(4L, 2L, 3L, 5L, 3L, 3L, 5L, 3L, 2L, 4L, 
    4L, 3L, 4L, 3L, 4L, 4L, 3L, 4L, 2L, 2L, 2L, 4L, 5L, 5L, 4L, 
    3L, 2L, 4L, 5L, 5L, 5L, 3L, 2L, 2L, 5L, 4L, 4L, 5L, 4L, 3L, 
    5L, 5L, 4L, 5L, 4L, 2L, 2L, 5L, 4L, 4L, 2L, 3L, 5L, 5L, 2L, 
    4L, 4L, 4L, 5L, 3L, 4L, 5L, 4L, 4L, 2L, 5L, 5L, 3L, 5L, 5L, 
    2L, 3L, 5L, 3L, 4L, 2L, 2L, 5L, 3L, 4L, 2L, 2L, 5L, 5L, 5L, 
    2L, 2L, 3L, 3L, 2L, 3L, 5L, 4L, 3L, 4L, 3L, 4L, 4L, 5L, 5L, 
    5L, 4L, 5L, 3L, 4L, 2L, 5L, 5L, 4L, 3L, 3L, 2L, 2L, 5L, 5L, 
    4L, 5L, 5L, 2L, 5L, 5L, 2L, 5L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L), .Label = c("", "ZPD1", "ZPD2", "ZPD3", 
    "ZPD4"), class = "factor"), resident_levelofdifficulty = structure(c(2L, 
    2L, 2L, 2L, 2L, 3L, 2L, 2L, 4L, 2L, 4L, 2L, 4L, 2L, 2L, 4L, 
    2L, 2L, 4L, 2L, 4L, 2L, 4L, 2L, 2L, 2L, 2L, 2L, 4L, 2L, 4L, 
    2L, 4L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 2L, 2L, 
    2L, 2L, 4L, 4L, 2L, 2L, 4L, 3L, 2L, 4L, 4L, 3L, 2L, 2L, 4L, 
    2L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 2L, 2L, 2L, 4L, 4L, 
    4L, 2L, 2L, 2L, 4L, 2L, 4L, 4L, 3L, 2L, 2L, 3L, 3L, 2L, 2L, 
    2L, 2L, 3L, 4L, 2L, 4L, 2L, 2L, 3L, 2L, 2L, 2L, 2L, 4L, 2L, 
    2L, 4L, 2L, 2L, 2L, 2L, 2L, 3L, 2L, 2L, 2L, 3L, 2L, 2L, 3L, 
    2L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", 
    "Average", "Easy", "Hard"), class = "factor"), attending_levelofdifficulty = structure(c(3L, 
    2L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 3L, 3L, 2L, 4L, 2L, 3L, 2L, 
    2L, 2L, 3L, 4L, 2L, 4L, 4L, 2L, 2L, 4L, 3L, 4L, 4L, 3L, 4L, 
    4L, 4L, 2L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 2L, 4L, 2L, 4L, 
    4L, 2L, 4L, 4L, 2L, 2L, 4L, 2L, 2L, 2L, 4L, 4L, 2L, 4L, 4L, 
    2L, 4L, 5L, 3L, 4L, 2L, 4L, 4L, 4L, 3L, 2L, 2L, 2L, 4L, 4L, 
    3L, 2L, 3L, 2L, 4L, 2L, 2L, 4L, 3L, 3L, 2L, 3L, 2L, 2L, 2L, 
    3L, 4L, 3L, 4L, 2L, 4L, 2L, 2L, 2L, 4L, 4L, 2L, 2L, 4L, 2L, 
    2L, 4L, 2L, 2L, 2L, 2L, 4L, 2L, 2L, 2L, 4L, 2L, 2L, 2L, 2L, 
    4L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", 
    "Average", "Easy", "Hard", "average"), class = "factor"), 
    rZPD1 = c(3L, 1L, 4L, 3L, 2L, 2L, 4L, 2L, 2L, 3L, 4L, 4L, 
    4L, 3L, 3L, 3L, 4L, 4L, 3L, 3L, 3L, 4L, 1L, 4L, 3L, 4L, 3L, 
    3L, 4L, 4L, 4L, 3L, 3L, 2L, 4L, 4L, 3L, 4L, 3L, 3L, 4L, 4L, 
    1L, 2L, 3L, 3L, 3L, 1L, 4L, 4L, 1L, 3L, 4L, 4L, 1L, 3L, 4L, 
    3L, 4L, 1L, 4L, 3L, 2L, 4L, 1L, 3L, 3L, 3L, 4L, 4L, 1L, 2L, 
    4L, 3L, 4L, 2L, 1L, 4L, 3L, 3L, 1L, 2L, 4L, 1L, 4L, 1L, 2L, 
    2L, 2L, 2L, 4L, 3L, 3L, 2L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 3L, 
    4L, 3L, 3L, 1L, 4L, 4L, 3L, 2L, 3L, 2L, 2L, 4L, 4L, 3L, 4L, 
    4L, 1L, 3L, 4L, 3L, 4L, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA), rZPD2 = c(3L, 1L, 4L, 3L, 1L, 2L, 4L, 2L, 1L, 
    3L, 4L, 2L, 3L, 3L, 3L, 2L, 3L, 4L, 1L, 1L, 2L, 4L, 1L, 4L, 
    2L, 4L, 2L, 3L, 4L, 4L, 4L, 2L, 2L, 1L, 4L, 3L, 3L, 4L, 3L, 
    2L, 4L, 4L, 1L, 3L, 3L, 3L, 3L, 1L, 3L, 2L, 1L, 2L, 4L, 4L, 
    1L, 2L, 4L, 3L, 4L, 2L, 3L, 3L, 2L, 4L, 1L, 3L, 3L, 3L, 3L, 
    4L, 1L, 2L, 4L, 2L, 4L, 1L, 1L, 3L, 2L, 3L, 1L, 1L, 4L, 1L, 
    4L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 2L, 4L, 3L, 3L, 3L, 4L, 
    4L, 4L, 3L, 4L, 3L, 3L, 1L, 3L, 4L, 3L, 2L, 2L, 2L, 2L, 4L, 
    4L, 3L, 3L, 4L, 1L, 1L, 4L, 3L, 4L, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA), rZPD3 = c(3L, 1L, 2L, 3L, 1L, 1L, 
    4L, 1L, 1L, 3L, 2L, 2L, 3L, 3L, 2L, 2L, 2L, 3L, 1L, 1L, 2L, 
    3L, 1L, 4L, 2L, 1L, 1L, 3L, 4L, 4L, 4L, 4L, 1L, 1L, 3L, 2L, 
    3L, 4L, 2L, 1L, 3L, 4L, 1L, 1L, 3L, 3L, 3L, 1L, 2L, 1L, 1L, 
    1L, 4L, 4L, 1L, 2L, 3L, 3L, 4L, 1L, 2L, 3L, 2L, 3L, 1L, 3L, 
    3L, 3L, 3L, 3L, 1L, 2L, 4L, 2L, 4L, 1L, 2L, 2L, 2L, 3L, 1L, 
    1L, 4L, 1L, 4L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 1L, 3L, 3L, 
    3L, 3L, 3L, 4L, 4L, 3L, 4L, 2L, 3L, 1L, 3L, 4L, 3L, 2L, 2L, 
    2L, 2L, 4L, 4L, 3L, 2L, 4L, 1L, 3L, 4L, 3L, 4L, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA), rZPD4 = c(3L, 1L, 2L, 
    3L, 1L, 1L, 4L, 1L, 1L, 3L, 4L, 2L, 3L, 3L, 2L, 2L, 2L, 3L, 
    1L, 1L, 2L, 3L, 2L, 3L, 2L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 
    1L, 3L, 2L, 3L, 3L, 2L, 1L, 3L, 3L, 2L, 2L, 3L, 3L, 3L, 1L, 
    4L, 2L, 1L, 2L, 3L, 4L, 1L, 4L, 3L, 3L, 4L, 1L, 4L, 3L, 2L, 
    3L, 1L, 3L, 3L, 4L, 3L, 4L, 1L, 2L, 4L, 2L, 3L, 1L, 1L, 2L, 
    3L, 3L, 1L, 1L, 3L, 1L, 4L, 1L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 
    1L, 3L, 4L, 4L, 4L, 3L, 4L, 4L, 3L, 4L, 1L, 3L, 1L, 3L, 3L, 
    3L, 2L, 2L, 3L, 3L, 4L, 4L, 3L, 2L, 4L, 1L, 3L, 4L, 3L, 3L, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), aZPD1 = c(4L, 
    2L, 1L, 4L, 3L, 3L, 4L, 2L, 2L, 4L, 4L, 3L, 4L, 3L, 4L, 4L, 
    3L, 4L, 3L, 2L, 3L, 4L, 4L, 4L, 4L, 4L, 3L, 4L, 4L, 4L, 4L, 
    4L, 2L, 4L, 4L, 4L, 4L, 4L, 4L, 3L, 4L, 4L, 4L, 3L, 4L, 3L, 
    3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 4L, 4L, 1L, 4L, 4L, 4L, 4L, 4L, 1L, 2L, 4L, 3L, 4L, 3L, 
    1L, 2L, 3L, 4L, 2L, 2L, 4L, 4L, 4L, 4L, 2L, 4L, 3L, 3L, 3L, 
    4L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 3L, 3L, 3L, 
    4L, 4L, 3L, 4L, 4L, 3L, 3L, 4L, 4L, 2L, 4L, 2L, 2L, 4L, 4L, 
    1L, 4L, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), 
    aZPD2 = c(3L, 2L, 1L, 4L, 2L, 2L, 4L, 2L, 2L, 4L, 4L, 2L, 
    4L, 3L, 4L, 2L, 4L, 4L, 1L, 1L, 2L, 4L, 4L, 4L, 4L, 3L, 2L, 
    4L, 4L, 4L, 4L, 3L, 2L, 2L, 4L, 4L, 4L, 4L, 4L, 2L, 4L, 4L, 
    4L, 4L, 3L, 4L, 4L, 4L, 3L, 1L, 3L, 4L, 4L, 4L, 3L, 4L, 4L, 
    4L, 4L, 2L, 4L, 4L, 4L, 4L, 1L, 4L, 4L, 4L, 4L, 4L, 1L, 2L, 
    4L, 2L, 3L, 1L, 1L, 3L, 2L, 4L, 1L, 2L, 4L, 4L, 4L, 4L, 1L, 
    4L, 2L, 3L, 3L, 4L, 2L, 2L, 4L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 
    4L, 3L, 3L, 1L, 4L, 4L, 4L, 2L, 4L, 3L, 1L, 4L, 4L, 2L, 3L, 
    2L, 2L, 3L, 4L, 1L, 4L, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA), aZPD3 = c(3L, 2L, 1L, 3L, 2L, 2L, 4L, 1L, 1L, 
    4L, 4L, 2L, 3L, 3L, 2L, 2L, 2L, 3L, 1L, 1L, 3L, 3L, 4L, 4L, 
    4L, 1L, 1L, 4L, 4L, 4L, 4L, 1L, 1L, 2L, 4L, 3L, 3L, 4L, 4L, 
    1L, 4L, 4L, 3L, 3L, 3L, 4L, 4L, 4L, 2L, 2L, 3L, 2L, 4L, 4L, 
    3L, 3L, 3L, 4L, 4L, 1L, 4L, 4L, 3L, 3L, 1L, 4L, 4L, 3L, 4L, 
    4L, 1L, 2L, 4L, 2L, 3L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 4L, 4L, 
    4L, 4L, 1L, 4L, 2L, 3L, 3L, 4L, 2L, 2L, 4L, 4L, 3L, 4L, 4L, 
    4L, 4L, 3L, 4L, 2L, 3L, 1L, 3L, 4L, 4L, 2L, 3L, 2L, 1L, 3L, 
    4L, 2L, 3L, 2L, 2L, 3L, 4L, 1L, 3L, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA), aZPD4 = c(3L, 2L, 1L, 4L, 3L, 3L, 
    4L, 1L, 1L, 3L, 4L, 2L, 3L, 3L, 4L, 4L, 2L, 2L, 2L, 2L, 1L, 
    4L, 4L, 4L, 3L, 3L, 1L, 4L, 4L, 4L, 4L, 2L, 1L, 2L, 4L, 4L, 
    4L, 4L, 4L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 1L, 3L, 4L, 
    2L, 4L, 4L, 3L, 4L, 4L, 4L, 4L, 1L, 4L, 4L, 4L, 2L, 2L, 3L, 
    3L, 2L, 3L, 3L, 1L, 2L, 3L, 2L, 1L, 1L, 1L, 2L, 4L, 4L, 1L, 
    2L, 2L, 4L, 4L, 4L, 1L, 3L, 2L, 3L, 2L, 4L, 2L, 3L, 2L, 4L, 
    4L, 4L, 4L, 4L, 3L, 2L, 4L, 1L, 3L, 1L, 4L, 4L, 4L, 2L, 2L, 
    2L, 1L, 4L, 4L, 2L, 3L, 2L, 2L, 4L, 4L, 1L, 3L, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA), Rscore = structure(c(22L, 
    3L, 30L, 22L, 7L, 8L, 1L, 8L, 7L, 22L, 31L, 24L, 27L, 22L, 
    21L, 17L, 9L, 3L, 11L, 11L, 17L, 32L, 4L, 34L, 17L, 29L, 
    16L, 22L, 34L, 34L, 34L, 20L, 7L, 7L, 32L, 25L, 22L, 34L, 
    21L, 14L, 32L, 34L, 4L, 4L, 22L, 22L, 22L, 3L, 26L, 12L, 
    3L, 15L, 34L, 35L, 3L, 19L, 32L, 22L, 35L, 6L, 26L, 22L, 
    9L, 35L, 3L, 22L, 22L, 23L, 27L, 33L, 1L, 1L, 1L, 1L, 1L, 
    2L, 5L, 25L, 18L, 22L, 3L, 7L, 34L, 3L, 35L, 3L, 9L, 9L, 
    10L, 10L, 1L, 22L, 22L, 8L, 1L, 28L, 28L, 28L, 32L, 35L, 
    35L, 22L, 35L, 1L, 1L, 3L, 27L, 34L, 22L, 9L, 17L, 10L, 10L, 
    35L, 35L, 22L, 25L, 35L, 3L, 13L, 35L, 22L, 34L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "ZPD1 - , ZPD2 - , ZPD3 - , ZPD4 - ", 
    "ZPD1 - 1, ZPD2 - 1, ZPD3 - 1, ZPD4 - 1", "ZPD1 - 1, ZPD2 - 1, ZPD3 - 1, ZPD4 - 2", 
    "ZPD1 - 1, ZPD2 - 1, ZPD3 - 2, ZPD4 - 1", "ZPD1 - 1, ZPD2 - 2, ZPD3 - 1, ZPD4 - 1", 
    "ZPD1 - 2, ZPD2 - 1, ZPD3 - 1, ZPD4 - 1", "ZPD1 - 2, ZPD2 - 2, ZPD3 - 1, ZPD4 - 1", 
    "ZPD1 - 2, ZPD2 - 2, ZPD3 - 2, ZPD4 - 2", "ZPD1 - 2, ZPD2 - 2, ZPD3 - 2, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 1, ZPD3 - 1, ZPD4 - 1", "ZPD1 - 3, ZPD2 - 1, ZPD3 - 1, ZPD4 - 4", 
    "ZPD1 - 3, ZPD2 - 1, ZPD3 - 3, ZPD4 - 3", "ZPD1 - 3, ZPD2 - 2, ZPD3 - 1, ZPD4 - 1", 
    "ZPD1 - 3, ZPD2 - 2, ZPD3 - 1, ZPD4 - 2", "ZPD1 - 3, ZPD2 - 2, ZPD3 - 1, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 2, ZPD3 - 2, ZPD4 - 2", "ZPD1 - 3, ZPD2 - 2, ZPD3 - 2, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 2, ZPD3 - 2, ZPD4 - 4", "ZPD1 - 3, ZPD2 - 2, ZPD3 - 4, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 3, ZPD3 - 2, ZPD4 - 2", "ZPD1 - 3, ZPD2 - 3, ZPD3 - 3, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 3, ZPD3 - 3, ZPD4 - 4", "ZPD1 - 4, ZPD2 - 2, ZPD3 - 2, ZPD4 - 2", 
    "ZPD1 - 4, ZPD2 - 3, ZPD3 - 2, ZPD4 - 2", "ZPD1 - 4, ZPD2 - 3, ZPD3 - 2, ZPD4 - 4", 
    "ZPD1 - 4, ZPD2 - 3, ZPD3 - 3, ZPD4 - 3", "ZPD1 - 4, ZPD2 - 3, ZPD3 - 3, ZPD4 - 4", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 1, ZPD4 - 1", "ZPD1 - 4, ZPD2 - 4, ZPD3 - 2, ZPD4 - 2", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 2, ZPD4 - 4", "ZPD1 - 4, ZPD2 - 4, ZPD3 - 3, ZPD4 - 3", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 3, ZPD4 - 4", "ZPD1 - 4, ZPD2 - 4, ZPD3 - 4, ZPD4 - 3", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 4, ZPD4 - 4"), class = "factor"), 
    Ascore = structure(c(31L, 7L, 2L, 38L, 14L, 14L, 1L, 6L, 
    6L, 40L, 41L, 13L, 37L, 20L, 35L, 26L, 1L, 1L, 10L, 5L, 16L, 
    38L, 41L, 41L, 40L, 28L, 11L, 41L, 41L, 41L, 41L, 27L, 1L, 
    25L, 41L, 38L, 38L, 41L, 41L, 12L, 41L, 41L, 38L, 21L, 32L, 
    22L, 22L, 41L, 29L, 23L, 32L, 34L, 41L, 41L, 31L, 38L, 38L, 
    41L, 41L, 24L, 41L, 41L, 38L, 1L, 3L, 40L, 40L, 36L, 40L, 
    40L, 1L, 1L, 40L, 13L, 30L, 9L, 2L, 8L, 15L, 35L, 4L, 7L, 
    39L, 41L, 41L, 41L, 4L, 40L, 13L, 20L, 19L, 41L, 13L, 14L, 
    39L, 33L, 38L, 41L, 41L, 41L, 40L, 36L, 41L, 17L, 1L, 9L, 
    38L, 41L, 22L, 25L, 36L, 18L, 9L, 38L, 41L, 7L, 31L, 7L, 
    7L, 32L, 41L, 2L, 37L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L), .Label = c("", "ZPD1 - 1, ZPD2 - 1, ZPD3 - 1, ZPD4 - 1", 
    "ZPD1 - 1, ZPD2 - 1, ZPD3 - 1, ZPD4 - 2", "ZPD1 - 2, ZPD2 - 1, ZPD3 - 1, ZPD4 - 1", 
    "ZPD1 - 2, ZPD2 - 1, ZPD3 - 1, ZPD4 - 2", "ZPD1 - 2, ZPD2 - 2, ZPD3 - 1, ZPD4 - 1", 
    "ZPD1 - 2, ZPD2 - 2, ZPD3 - 2, ZPD4 - 2", "ZPD1 - 2, ZPD2 - 3, ZPD3 - 2, ZPD4 - 2", 
    "ZPD1 - 3, ZPD2 - 1, ZPD3 - 1, ZPD4 - 1", "ZPD1 - 3, ZPD2 - 1, ZPD3 - 1, ZPD4 - 2", 
    "ZPD1 - 3, ZPD2 - 2, ZPD3 - 1, ZPD4 - 1", "ZPD1 - 3, ZPD2 - 2, ZPD3 - 1, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 2, ZPD3 - 2, ZPD4 - 2", "ZPD1 - 3, ZPD2 - 2, ZPD3 - 2, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 2, ZPD3 - 2, ZPD4 - 4", "ZPD1 - 3, ZPD2 - 2, ZPD3 - 3, ZPD4 - 1", 
    "ZPD1 - 3, ZPD2 - 3, ZPD3 - 2, ZPD4 - 1", "ZPD1 - 3, ZPD2 - 3, ZPD3 - 2, ZPD4 - 2", 
    "ZPD1 - 3, ZPD2 - 3, ZPD3 - 3, ZPD4 - 2", "ZPD1 - 3, ZPD2 - 3, ZPD3 - 3, ZPD4 - 3", 
    "ZPD1 - 3, ZPD2 - 4, ZPD3 - 3, ZPD4 - 4", "ZPD1 - 3, ZPD2 - 4, ZPD3 - 4, ZPD4 - 4", 
    "ZPD1 - 4, ZPD2 - 1, ZPD3 - 2, ZPD4 - 3", "ZPD1 - 4, ZPD2 - 2, ZPD3 - 1, ZPD4 - 1", 
    "ZPD1 - 4, ZPD2 - 2, ZPD3 - 2, ZPD4 - 2", "ZPD1 - 4, ZPD2 - 2, ZPD3 - 2, ZPD4 - 4", 
    "ZPD1 - 4, ZPD2 - 3, ZPD3 - 1, ZPD4 - 2", "ZPD1 - 4, ZPD2 - 3, ZPD3 - 1, ZPD4 - 3", 
    "ZPD1 - 4, ZPD2 - 3, ZPD3 - 2, ZPD4 - 1", "ZPD1 - 4, ZPD2 - 3, ZPD3 - 3, ZPD4 - 1", 
    "ZPD1 - 4, ZPD2 - 3, ZPD3 - 3, ZPD4 - 3", "ZPD1 - 4, ZPD2 - 3, ZPD3 - 3, ZPD4 - 4", 
    "ZPD1 - 4, ZPD2 - 3, ZPD3 - 4, ZPD4 - 4", "ZPD1 - 4, ZPD2 - 4, ZPD3 - 2, ZPD4 - 2", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 2, ZPD4 - 4", "ZPD1 - 4, ZPD2 - 4, ZPD3 - 3, ZPD4 - 2", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 3, ZPD4 - 3", "ZPD1 - 4, ZPD2 - 4, ZPD3 - 3, ZPD4 - 4", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 4, ZPD4 - 2", "ZPD1 - 4, ZPD2 - 4, ZPD3 - 4, ZPD4 - 3", 
    "ZPD1 - 4, ZPD2 - 4, ZPD3 - 4, ZPD4 - 4"), class = "factor"), 
    RawZw = structure(c(8L, 2L, 16L, 8L, 6L, 6L, 1L, 6L, 6L, 
    8L, 16L, 16L, 17L, 8L, 10L, 10L, 1L, 1L, 4L, 4L, 10L, 17L, 
    3L, 17L, 10L, 15L, 11L, 8L, 17L, 17L, 17L, 12L, 1L, 3L, 17L, 
    18L, 8L, 17L, 10L, 11L, 17L, 17L, 3L, 3L, 8L, 8L, 8L, 2L, 
    18L, 1L, 2L, 11L, 17L, 14L, 2L, 12L, 17L, 8L, 14L, 3L, 18L, 
    8L, 5L, 1L, 2L, 8L, 8L, 13L, 13L, 13L, 1L, 1L, 1L, 1L, 1L, 
    1L, 3L, 18L, 10L, 8L, 2L, 6L, 17L, 2L, 14L, 2L, 5L, 5L, 7L, 
    7L, 1L, 8L, 8L, 6L, 1L, 17L, 17L, 17L, 17L, 14L, 14L, 8L, 
    14L, 1L, 1L, 2L, 17L, 17L, 8L, 5L, 7L, 7L, 7L, 14L, 14L, 
    8L, 18L, 14L, 2L, 9L, 14L, 8L, 17L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L, 1L, 1L, 1L), .Label = c("", "1", "1, 2", "1, 3", 
    "2", "2, 1", "2, 3", "3", "3, 1", "3, 2", "3, 2, 1", "3, 2, 4", 
    "3, 4", "4", "4, 1", "4, 2", "4, 3", "4, 3, 2"), class = "factor"), 
    AttRawZw = structure(c(19L, 4L, 2L, 19L, 10L, 10L, 1L, 5L, 
    5L, 19L, 14L, 10L, 19L, 7L, 16L, 18L, 1L, 1L, 9L, 5L, 11L, 
    19L, 14L, 14L, 19L, 20L, 11L, 14L, 14L, 14L, 14L, 21L, 1L, 
    16L, 14L, 19L, 19L, 14L, 14L, 11L, 14L, 14L, 19L, 13L, 19L, 
    13L, 13L, 14L, 23L, 15L, 19L, 16L, 14L, 14L, 19L, 19L, 19L, 
    14L, 14L, 17L, 14L, 14L, 19L, 1L, 3L, 19L, 19L, 22L, 19L, 
    19L, 1L, 1L, 19L, 10L, 20L, 8L, 2L, 6L, 12L, 16L, 5L, 4L, 
    16L, 14L, 14L, 14L, 5L, 19L, 10L, 7L, 10L, 14L, 10L, 10L, 
    16L, 19L, 19L, 14L, 14L, 14L, 19L, 22L, 14L, 11L, 1L, 8L, 
    19L, 14L, 13L, 16L, 22L, 10L, 8L, 19L, 14L, 4L, 19L, 4L, 
    4L, 19L, 14L, 2L, 19L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
    1L, 1L, 1L), .Label = c("", "1", "1, 2", "2", "2, 1", "2, 3", 
    "3", "3, 1", "3, 1, 2", "3, 2", "3, 2, 1", "3, 2, 4", "3, 4", 
    "4", "4, 1, 2, 3", "4, 2", "4, 2, 1", "4, 2, 2", "4, 3", 
    "4, 3, 1", "4, 3, 1, 2", "4, 3, 2", "4, 3, 2, 1"), class = "factor")), .Names = c("X...recoder_date", 
"record_duration", "q2_feedback_during_operation", "q3_feedback_evaluation_form", 
"Q4_feedback_lead_to", "q4_text", "q6_zones_use", "q7_suggestion_for_improvement", 
"case_date", "resident", "year", "attending", "subspecialty", 
"case", "zpd", "resident_levelofdifficulty", "attending_levelofdifficulty", 
"rZPD1", "rZPD2", "rZPD3", "rZPD4", "aZPD1", "aZPD2", "aZPD3", 
"aZPD4", "Rscore", "Ascore", "RawZw", "AttRawZw"), row.names = c(NA, 
-135L), class = "data.frame")

data_01$case_date1<-mdy(data_01$case_date)

data_01$zpd<-car::recode(data_01$zpd,"'ZPD 4'='ZPD4'")

#all data
data_all<-data_01

data_all$resident<-c("All")
data_all$subspecialty<-c("All")
data_all$case<-c("All")

#all subspecialy specific
data_all_resident<-data_01

data_all_resident$resident<-data_01$resident
data_all_resident$subspecialty<-c("All")
data_all_resident$case<-c("All")

#all subspecialy specific
data_all_subespecialty<-data_01

data_all_subespecialty$resident<-c("All")
data_all_subespecialty$subspecialty<-data_01$subspecialty
data_all_subespecialty$case<-c("All")

#all case specific
data_all_case<-data_01

data_all_case$resident<-c("All")
data_all_case$subspecialty<-c("All")
data_all_case$case<-data_01$case

#all resident and subspecialy specific
data_all_residentsubs<-data_01

data_all_residentsubs$resident<-data_01$resident
data_all_residentsubs$subspecialty<-data_01$subspecialty
data_all_residentsubs$case<-c("All")

#all resident and case specific
data_all_residentcase<-data_01

data_all_residentcase$resident<-data_01$resident
data_all_residentcase$subspecialty<-c("All")
data_all_residentcase$case<-data_01$case

#all  case and subespecialty specific
data_all_casesubs<-data_01

data_all_casesubs$resident<-c("All")
data_all_casesubs$subspecialty<-data_01$subspecialty
data_all_casesubs$case<-data_01$case

data_0<-rbind(data_01,
              data_all,
              data_all_resident,
              data_all_subespecialty,
              data_all_case,
              data_all_residentsubs,
              data_all_residentcase,
              data_all_casesubs)

data_0$case_date1<-mdy(data_0$case_date)

data_0$zpd<-car::recode(data_0$zpd,"'ZPD 4'='ZPD4'")

# data$recoder_date1<-as.POSIXct(data$recoder_date,
#                       format='%m/%d/%y %H:%M')

# pkgStream is a reactive expression that represents a stream of
# new package download data; up to once a second it may return a
# data frame of new downloads since the last update.
# pkgStream <- packageStream()

# pkgData is a reactive expression that accumulates previous values
# of pkgStream, discarding any that are older than maxAgeSecs.
# maxAgeSecs <- 60 * 5 
# pkgData <- packageData(pkgStream, maxAgeSecs)
```

Inputs {.sidebar}
-------------------------------------------------------------------  
### SAP dashboard
  

```{r}

# Rate at which to flag high download traffic
 # selectInput("attending", label = h3("Attending"), 
 #    choices = c("All", unique(as.character(data_0$attending))),
 #    selected="All")

# Rate at which to flag high download traffic
 selectInput("resident", label = h3("Resident"), 
    choices = c("All", unique(as.character(data_01$resident))),
    selected="All")

 # Rate at which to flag high download traffic
 selectInput("subspecialty", label = h3("Subspecialty"), 
    choices = c("All", unique(as.character(data_01$subspecialty))),
    selected="All")

 # Rate at which to flag high download traffic
 selectInput("case", label = h3("Case"), 
    choices = c("All", unique(as.character(data_01$case))),
    selected="All")

# # Maximum number of raw data rows to keep
# numericInput("maxrows", "Recent procedures and scores:", 10)

   # if (input$resident != "All") {
   #    data <- data[data$resident == input$resident,]
   #  }
   #  if (input$subspecialty != "All") {
   #    data <- data[data$subspecialty == input$subspecialty,]
   #  }
   #  if (input$case != "All") {
   #    data <- data[data$case == input$case,]
   #  }
# })
# data<-subset(data_0,data_0$subspecialty == subspecialty)
# data<-subset(data_0,data_0$case == case)

```


Column
-------------------------------------------------------------------

### Faculty use of ZPDs (%)  {.value-box}

```{r}
# dlCount is a reactive expression that keeps track of the total
# number of rows that have ever appeared through pkgStream.
# dlCount <- downloadCount(pkgStream)

# Emit the download count
renderValueBox({

    # data <- data_0

    # if (input$resident != "All") {
    #   data <- data[data$resident == input$resident,]
    # }
    # if (input$subspecialty != "All") {
    #   data <- data[data$subspecialty == input$subspecialty,]
    # }
    # if (input$case != "All") {
    #   data <- data[data$case == input$case,]
    # }

  # data<-subset(data_0,data_0$resident == input$resident &
  #                 data_0$subspecialty == input$subspecialty &
  #                 data_0$case == input$case)

# test<-data()$q6_zones_use


resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())

dlCount <- round(prop.table(table(data$q6_zones_use))[4]*100)

  valueBox(value=dlCount,
           icon = "fa-download",
           color = if (dlCount <= 50) "warning" else "primary")
})
```

### Total # of cases {.value-box}
  
```{r}
# downloadRate is a reactive expression that computes the download
# rate during this dashboard's lifetime.
# startTime <- as.numeric(Sys.time())
# downloadRate <- reactive({
#   elapsed <- as.numeric(Sys.time()) - startTime
#   nrow(pkgData()) / min(maxAgeSecs, elapsed)
# })

# Emit the download rate
renderValueBox({

    # data <- data_0
    # if (input$resident != "All") {
    #   data <- data[data$resident == input$resident,]
    # }
    # if (input$subspecialty != "All") {
    #   data <- data[data$subspecialty == input$subspecialty,]
    # }
    # if (input$case != "All") {
    #   data <- data[data$case == input$case,]
    # }

resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())


#count number of lines
  value<-length(data$case)

  valueBox(
    value = value,
    icon = "fa-area-chart"
    # color = if (rate >= input$rateThreshold) "warning" else "primary"
  )
})
```

### **ZPD 1** - *Highest level on case* {.value-box}

```{r}
# usrCount is a reactive expression that keeps an approximate
# count of all of the unique users that have been seen since the
# app started.

# Emit the user count
renderValueBox({

    # data <- data_0
    # if (input$resident != "All") {
    #   data <- data[data$resident == input$resident,]
    # }
    # if (input$subspecialty != "All") {
    #   data <- data[data$subspecialty == input$subspecialty,]
    # }
    # if (input$case != "All") {
    #   data <- data[data$case == input$case,]
    # }

resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())

#recoding ZPDs
# spd_rec<-car::recode(data$zpd,"
#                                     'ZPD1'=1;
#                                     'ZPD2'=2;
#                                     'ZPD3'=3;
#                                     'ZPD4'=4;
#                                     'ZPD 4'=4;
#                                     ''=NA
#                           ")

#getting the highest
highest_zpd <- max(as.numeric(na.omit(as.character(data$aZPD1))))

#recoding back to category
usrCount <- car::recode(highest_zpd,"
                                    1='Show and tell';
                                    2='Active help';
                                    3='Passive help';
                                    4='No help'
                          ")

color <- car::recode(highest_zpd,"
                                    1='red';
                                    2='orange';
                                    3='blue';
                                    4='green'
                          ")

#plot value
valueBox(value = usrCount, 
         icon = "fa-users",
         color = color)
})
```

### **ZPD 2** - *Highest level on case* {.value-box}

```{r}
# usrCount is a reactive expression that keeps an approximate
# count of all of the unique users that have been seen since the
# app started.

# Emit the user count
renderValueBox({

    # data <- data_0
    # if (input$resident != "All") {
    #   data <- data[data$resident == input$resident,]
    # }
    # if (input$subspecialty != "All") {
    #   data <- data[data$subspecialty == input$subspecialty,]
    # }
    # if (input$case != "All") {
    #   data <- data[data$case == input$case,]
    # }

resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())

#getting the highest
highest_zpd <- max(as.numeric(na.omit(as.character(data$aZPD2))))

#recoding back to category
usrCount <- car::recode(highest_zpd,"
                                    1='Show and tell';
                                    2='Active help';
                                    3='Passive help';
                                    4='No help'
                          ")

color <- car::recode(highest_zpd,"
                                    1='red';
                                    2='orange';
                                    3='blue';
                                    4='green'
                          ")

#plot value
valueBox(value = usrCount, 
         icon = "fa-users",
         color = color)
})
```

### **ZPD 3** - *Highest level on case* {.value-box}

```{r}
# usrCount is a reactive expression that keeps an approximate
# count of all of the unique users that have been seen since the
# app started.

# Emit the user count
renderValueBox({

    # data <- data_0
    # if (input$resident != "All") {
    #   data <- data[data$resident == input$resident,]
    # }
    # if (input$subspecialty != "All") {
    #   data <- data[data$subspecialty == input$subspecialty,]
    # }
    # if (input$case != "All") {
    #   data <- data[data$case == input$case,]
    # }

resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())

#getting the highest
highest_zpd <- max(as.numeric(na.omit(as.character(data$aZPD3))))

#recoding back to category
usrCount <- car::recode(highest_zpd,"
                                    1='Show and tell';
                                    2='Active help';
                                    3='Passive help';
                                    4='No help'
                          ")

color <- car::recode(highest_zpd,"
                                    1='red';
                                    2='orange';
                                    3='blue';
                                    4='green'
                          ")

#plot value
valueBox(value = usrCount, 
         icon = "fa-users",
         color = color)
})
```

### **ZPD 4** - *Highest level on case* {.value-box}

```{r}
# usrCount is a reactive expression that keeps an approximate
# count of all of the unique users that have been seen since the
# app started.

# Emit the user count
renderValueBox({

    # data <- data_0
    # if (input$resident != "All") {
    #   data <- data[data$resident == input$resident,]
    # }
    # if (input$subspecialty != "All") {
    #   data <- data[data$subspecialty == input$subspecialty,]
    # }
    # if (input$case != "All") {
    #   data <- data[data$case == input$case,]
    # }

resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())

#getting the highest
highest_zpd <- max(as.numeric(na.omit(as.character(data$aZPD4))))

#recoding back to category
usrCount <- car::recode(highest_zpd,"
                                    1='Show and tell';
                                    2='Active help';
                                    3='Passive help';
                                    4='No help'
                          ")

color <- car::recode(highest_zpd,"
                                    1='red';
                                    2='orange';
                                    3='blue';
                                    4='green'
                          ")

#plot value
valueBox(value = usrCount, 
         icon = "fa-users",
         color = color)
})
```

Column
-----------------------------------------------------------


### ZPD evolving overtime {data-height=1550}

```{r}
# data <- data_0

# selectedData <- reactive({
#   if (input$resident != "All") {
#       data <- data[data$resident == input$resident,]
#     }
#     if (input$subspecialty != "All") {
#       data <- data[data$subspecialty == input$subspecialty,]
#     }
#     if (input$case != "All") {
#       data <- data[data$case == input$case,]
#     }
# })

# data %>% 
#   group_by(case_date1,zpd) %>%
#   summarise(no_rows = length(case)) %>%
#   na.omit() %>%
#   spread(zpd,no_rows) -> data2

# data2<-as.data.frame(data2)

# NAto0<-function(x){
#   car::recode(x,"NA=0")
#   }

# temp<-lapply(data2[,-1],NAto0)

# data2$Total<-rowSums(as.data.frame(temp))

# data3 <- xts(data2[,-1], order.by=as.Date(data2[,1]), "%m/%d/%Y")

# dygraph(data3, main = "") %>% 
#   dyRangeSelector(dateWindow = c(min(data2$case_date1), 
#                    max(data2$case_date1)))
 
resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

renderPlotly({

  data_0$aZPD1<-car::recode(data_0$aZPD1,"1='show_tell';
                                        2='active_help';
                                        3='passive_help';
                                        4='no_help'")


data_0$aZPD2<-car::recode(data_0$aZPD2,"1='show_tell';
                                        2='active_help';
                                        3='passive_help';
                                        4='no_help'")

data_0$aZPD3<-car::recode(data_0$aZPD3,"1='show_tell';
                                        2='active_help';
                                        3='passive_help';
                                        4='no_help'")

data_0$aZPD4<-car::recode(data_0$aZPD4,"1='show_tell';
                                        2='active_help';
                                        3='passive_help';
                                        4='no_help'")

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())


data_zpd<-with(data,data.frame(aZPD1,aZPD2,aZPD3,aZPD4))

    # pkgData() %>%
    data_zpd %>%
    # tally() %>%
    # arrange(desc(n), tolower(package)) %>%
    gather() %>%
    group_by(key,value) %>%
    count(key,value) %>%
    spread(value,n) -> tryout

tryout<-as.data.frame(tryout)
tryout$key<-as.factor(tryout$key)

if("show_tell" %in% colnames(tryout))
{
  tryout$show_tell<-tryout$show_tell

} else { 

  tryout$show_tell<-c(0,0,0,0)

}

if("active_help" %in% colnames(tryout))
{
  tryout$active_help<-tryout$active_help
  
} else { 

  tryout$active_help<-c(0,0,0,0)

}

if("passive_help" %in% colnames(tryout))
{
  tryout$passive_help<-tryout$passive_help
  
} else { 

  tryout$passive_help<-c(0,0,0,0)

}

if("no_help" %in% colnames(tryout))
{
  tryout$no_help<-tryout$no_help
  
} else { 

  tryout$no_help<-c(0,0,0,0)

}


NAto0<-function(x){
  car::recode(x,"NA=0")
  }

  tryout_NAtozero<-lapply(tryout,NAto0)

tryout_NAtozero<-as.data.frame(tryout_NAtozero)

tryout_NAtozero$key<-recode(tryout_NAtozero$key, 
                    aZPD1="ZPD 1",
                    aZPD2="ZPD 2",
                    aZPD3="ZPD 3",
                    aZPD4="ZPD 4",)

toplot<-plot_ly(tryout_NAtozero,type = "bar", 
          x = ~key, 
          y = ~show_tell,
          text = tryout_NAtozero$show_tell, 
          textposition = 'auto',
          name='Show and Tell') %>%
      add_trace(y = ~active_help, 
                name = 'Active Help',
                text = tryout_NAtozero$active_help, 
                textposition = 'auto') %>%
      add_trace(y = ~passive_help,
                name = 'Passive Help',
                text = tryout_NAtozero$passive_help, 
                textposition = 'auto') %>%
      add_trace(y = ~no_help,
                name = 'No Help',
                text = tryout_NAtozero$no_help, 
                textposition = 'auto') %>%
      layout(yaxis = list(title = 'Days'),
           xaxis = list(title = 'Zones of Proximal Development'), 
            barmode = 'stack',
            legend=list(orientation='h'))
})

```

### Average ZPD level
  
```{r}
renderTable({

    #   data <- data_0
    # if (input$attending != "All") {
    #   data <- data[data$attending == input$attending,]
    # }
    
    # if (all(is.na(data$q7_suggestion_for_improvement))==TRUE) {

    #   "No comments"

    # } else{

resident<-reactive({input$resident})
subspecialty<-reactive({input$subspecialty})
case<-reactive({input$case})

data<-subset(data_0,data_0$resident == resident() &
                  data_0$subspecialty == subspecialty() &
                  data_0$case == case())


data_zpd<-with(data,data.frame(aZPD1,aZPD2,aZPD3,aZPD4))

    # pkgData() %>%
    data_zpd %>%
    # tally() %>%
    # arrange(desc(n), tolower(package)) %>%
    gather() %>%
    group_by(key) %>%
    summarise(mean=mean(na.omit(value)),sd=sd(na.omit(value))) -> group_by_zpd
  # mutate(percentage = n / nrow(pkgData()) * 100) %>%


  group_by_zpd$cat<-car::recode(group_by_zpd$mean,"
    1:1.999='Show/Tell';
    2:2.999='Active Help';
    3:3.999='Passive Help';
    4='No Help'") 

 group_by_zpd$key<-car::recode(group_by_zpd$key,"
      'aZPD1'='ZPD 1';
      'aZPD2'='ZPD 2';
      'aZPD3'='ZPD 3';
      'aZPD4'='ZPD 4'")

 group_by_zpd[,2]<-round(group_by_zpd[,2],2)

colnames(group_by_zpd)<-c("ZPDs","Average score", "Sd Score","Category")

group_by_zpd

group_by_tbl<-group_by_zpd[,-c(2,3)]

group_by_tbl
# 


    # select("Status" = q7_suggestion_for_improvement) %>%
    # as.data.frame() %>%

})
```

<!-- 
### Last performance evaluation {data-width=340}

```{r}
renderTable({

    #   data <- data_0
    # if (input$attending != "All") {
    #   data <- data[data$attending == input$attending,]
    # }
    
    # if (all(is.na(data$q7_suggestion_for_improvement))==TRUE) {

    #   "No comments"

    # } else{

    # pkgData() %>%
    data %>%
    # group_by(attending) %>%
    # tally() %>%
    # arrange(desc(n), tolower(package)) %>%
    arrange(data,case_date1) %>%
    # mutate(percentage = n / nrow(pkgData()) * 100) %>%
    select("Comment" = q7_suggestion_for_improvement) %>%
    as.data.frame() %>%
    head(10)

})

```
 -->
<!-- Functional
=======================================================================

Row
-----------------------------------------------------------------------
  
### Recent Downlads
  
```{r}
renderTable({
  downloads <- tail(pkgData(), n = input$maxrows)
  downloads <- downloads[,c("date", "time", "size", "r_version", 
                            "r_arch", "r_os", "package")]
  downloads[order(nrow(downloads):1),]
})
```

### Performance overtime

```{r}
library(dygraphs)
dygraph(nhtemp, main = "New Haven Temperatures") %>% 
  dyRangeSelector(dateWindow = c("1920-01-01", "1960-01-01"))
```

Row
-----------------------------------------------------------------------

### Comment

***

"Excellent exposure obviously putting on the electrode is not as easy at it looks but you persevered." (Haglund)

"Really nice job, now just user finer points to increase efficiency, this was a routing 3 level but handled everything nice and safely" (Vissoci)

"Doing a nice job on the drilling, more efficient as the day went along, again being careful not to go deep at the lateral margins when drilling and good pick up that our initial pin placement at top was in bad position" (Yoda)


Spine
=======================================================================
  
### Recent Downlads
  
```{r}
renderTable({
  downloads <- tail(pkgData(), n = input$maxrows)
  downloads <- downloads[,c("date", "time", "size", "r_version", 
                            "r_arch", "r_os", "package")]
  downloads[order(nrow(downloads):1),]
})
```

### Performance overtime

```{r}
library(dygraphs)
dygraph(nhtemp, main = "New Haven Temperatures") %>% 
  dyRangeSelector(dateWindow = c("1920-01-01", "1960-01-01"))
```
 -->